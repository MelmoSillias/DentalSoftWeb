{% extends 'appbase.html.twig' %}

{% block title %}Dossier Patient{% endblock %}

{% block main %}
<div class="container-fluid px-4">

  {# --- 1. Infos personnelles --- #}
  <div class="card shadow mb-4 accordion">
    <div class="card-header py-3 d-flex align-items-center justify-content-between" data-bs-toggle="collapse" data-bs-target="#collapsePatientInfos" style="cursor:pointer;">
      <h6 class="m-0 font-weight-bold text-primary"><i class="fas fa-user me-2"></i>Informations personnelles</h6>
    </div>
    <div id="collapsePatientInfos" class="collapse show">
      <div class="card-body">
        <div class="card-columns" id="patient-info-cards">
          {# JS injectera ici une card par champ (nom, prénom, etc.) #}
        </div>
        <button id="btn-save-patient" class="btn btn-primary mt-3" disabled>Enregistrer</button>
      </div>
    </div>
  </div>

  {# --- 2. Données complémentaires --- #}
  <div class="card shadow mb-4 accordion">
    <div class="card-header py-3 d-flex align-items-center justify-content-between" data-bs-toggle="collapse" data-bs-target="#collapseComplementData" style="cursor:pointer;">
      <h6 class="m-0 font-weight-bold text-primary"><i class="fas fa-layer-group me-2"></i>Données complémentaires</h6>
    </div>
    <div id="collapseComplementData" class="collapse show">
      <div class="card-body">
        <div class="card mb-4">
          <div class="card-header py-3 d-flex align-items-center justify-content-between">
            <h6 class="m-0 font-weight-bold text-primary">Allergies</h6>
            <button class="btn btn-primary" id="btn-add-allergy" data-bs-toggle="modal" data-bs-target="#addAllergyModal">
                <i class="fas fa-plus me-2"></i>Ajouter une allergie
              </button>
          </div>
          <div class="card-body"> 
            <div class="row mb-4 mx-2" id="allergies-cards">
              {# cartes AllergyViewModel + mini-formulaire d’ajout #}
            </div>
          </div>
        </div>

        <div class="card mb-4">
          <div class="card-header py-3 d-flex align-items-center justify-content-between">
            <h6 class="m-0 font-weight-bold text-primary">Antécédents médicaux</h6>
            <button class="btn btn-primary" id="btn-add-antecedent" data-bs-toggle="modal" data-bs-target="#addAntecedentModal">
                <i class="fas fa-plus me-2"></i>Ajouter un antécédent
              </button>
          </div>
          <div class="card-body"> 
            <div class="row mb-4 mx-2" id="antecedents-cards">
              {# cartes AntecedentViewModel + mini-formulaire d’ajout #}
            </div>
          </div>
        </div>

        <div class="card mb-4">
          <div class="card-header py-3 d-flex align-items-center justify-content-between">
            <h6 class="m-0 font-weight-bold text-primary">Contacts d’urgence</h6>
            <button class="btn btn-primary" id="btn-add-contact" data-bs-toggle="modal" data-bs-target="#addContactModal">
                <i class="fas fa-plus me-2"></i>Ajouter un contact
              </button>
          </div>
          <div class="card-body"> 
            <div class="row mb-4 mx-2" id="contacts-cards">
              {# cartes ContactUrgenceViewModel + mini-formulaire d’ajout #}
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>

  {# --- 3. Consultations --- #}
  <div class="card shadow mb-4 accordion">
    <div class="card-header py-3 d-flex align-items-center justify-content-between" data-bs-toggle="collapse" data-bs-target="#collapseConsultations" style="cursor:pointer;">
      <h6 class="m-0 font-weight-bold text-primary"><i class="fas fa-stethoscope me-2"></i>Consultations</h6>
    </div>
    <div id="collapseConsultations" class="collapse show">
      <div class="card-body">
        <div class="table-responsive">
          <table class="table table-striped table-hover" id="consultations-table">
            <thead class="thead-light">
              <tr>
                <th style="width: 2rem;"></th>
                <th>#</th>
                <th>Date / Heure</th>
                <th>Médecin</th>
                <th>Type</th>
                <th>Statut</th>
                <th>Actions</th>
              </tr>
            </thead>
            <tbody>
              {# JS injectera ici les lignes #}
            </tbody>
          </table>
        </div>
      </div>
    </div>
  </div>

  {# --- 4. Rendez-vous --- #}
  <div class="card shadow mb-4 accordion">
    <div class="card-header py-3 d-flex align-items-center justify-content-between" data-bs-toggle="collapse" data-bs-target="#collapseRDVs" style="cursor:pointer;">
      <h6 class="m-0 font-weight-bold text-primary"><i class="fas fa-calendar-alt me-2"></i>Rendez-vous</h6>
    </div>
    <div id="collapseRDVs" class="collapse show">
      <div class="card-body">
        <div class="table-responsive">
          <table class="table table-bordered" id="rdvs-table">
            <thead class="thead-light">
              <tr>
                <th>Date / Heure</th>
                <th>Salle</th>
                <th>Médecin</th>
                <th>Patient</th>
                <th>Statut</th>
              </tr>
            </thead>
            <tbody>
              {# JS injectera ici les RDV #}
            </tbody>
          </table>
        </div>
      </div>
    </div>
  </div>

</div>
{% endblock %}

{% block javascripts %}
{{ parent() }}
<script src="{{ asset('js/patientDossier.js') }}"></script>
{% endblock %}
